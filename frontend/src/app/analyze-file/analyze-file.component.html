<h2>Upload and analyze a XML file</h2>
<div id="browse-file">
    <span id="file-instruction">Select a target file: </span>
    <input type="file" id="upload-file" style="color:transparent;" onchange="this.style.color = 'white'; this.style.fontWeight= 'bold';" #fileInput >
</div>

<input type="button" id="proceed-to-analysis" value="Analyse"
(click)="analyseXmlFile(fileInput)">

<h2 *ngIf="showAnalysis">List of antivirus</h2>

<table *ngIf="showAnalysis" class="even">
    <thead>
        <tr>
            <th>Name</th>
            <th>Logo</th>
            <th>Detected</th>
            <th>Last Detection Update</th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let vendor of vendors">
            <td class="vendor-name">{{vendor.name}}</td>
            <td>
                <img [src]="vendor.logoUrl" alt="Logo of {{vendor.name}}" class="vendor-logo">
            </td>
            <td>
                <img *ngIf="vendor.hasDetected" src="assets/check.png" alt="Picture of a checkmark" class="status-icon">
                <img *ngIf="!vendor.hasDetected" src="assets/cross.png" alt="Picture of a red cross" class
                ="status-icon">
            </td>
            <td>{{vendor.lastDetectionUpdate}}</td>
        </tr>
    </tbody>
</table>

<br>
<h2 *ngIf="showAnalysis">List of DLLs</h2>
<table *ngIf="showAnalysis" class="odd">
    <thead>
        <tr>
            <th>Name</th>
            <th>Function</th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let dll of dlls">
            <td>{{dll.name}}</td>
            <td>{{dll.function}}</td>
        </tr>
    </tbody>
</table>

<br>
<h2 *ngIf="showAnalysis">Microsoft API Parsing results: </h2>
<table *ngIf="showAnalysis" class="even">
    <thead>
        <tr>
            <th>Description</th>
            <th>Microsoft doc link</th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let microsoftElement of microsoftResults">
            <td>{{microsoftElement.descr}}</td>
            <td><a [href]="microsoftElement.url" [ngStyle]="{color: isLink(microsoftElement.url)? 'blue; text-decoration: underline':'white'}">{{microsoftElement.url}}</a></td>
        </tr>
    </tbody>
</table>

<br>
<h2 *ngIf="showAnalysis">Events triggered and their link to Mitre attack: </h2>
<table *ngIf="showAnalysis" class="odd">
    <thead>
        <tr>
            <th>Mitre Attack technique</th>
            <th>Time</th>
            <th>Source</th>
            <th>Event ID</th>
            <th>Event internal data</th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let event of events">
            <td><a [href]="event.mitreAttackTechnique" [ngStyle]="{color: isLink(event.mitreAttackTechnique)? 'blue; text-decoration: underline':'white'}">{{event.mitreAttackTechnique}}</a></td>
            <td>{{event.runningTime}}</td>
            <td>{{event.source}}</td>
            <td>{{event.eventId}}</td>
            <td>{{event.eventDescription}}</td>
        </tr>
    </tbody>
</table>
<h2 *ngIf="showAnalysis">List of IPs and Geolocation</h2>
<div class="container">
    <div class="table-container">
        <table *ngIf="showAnalysis" class="even">
            <thead>
                <tr>
                    <th>IP</th>
                    <th>Country</th>
                    <th>Latitude and Longitude</th>
                    <th>Tor</th>
                    <th>Tor server name</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let ip of ips">
                    <td>{{ip.ip}}</td>
                    <td>{{ip.country}}</td>
                    <td>{{ip.lat}} ; {{ip.long}}</td>
                    <td>
                        <img *ngIf="ip.onTor" src="assets/check.png" alt="Picture of a checkmark" class="status-icon">
                        <img *ngIf="!ip.onTor" src="assets/cross.png" alt="Picture of a red cross" class
                        ="status-icon">
                    </td>
                    <td>{{ip.torServerName}}</td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="map-container">
        <div id="map"></div>
    </div>
</div>